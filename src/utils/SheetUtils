// src/utils/SheetUtils.js
const SheetUtils = (() => {
  /**
   * Ekstrahuje dane tekstowe ze wszystkich arkuszy.
   * Ignoruje puste wiersze.
   */
  function extractSheetText(spreadsheet) {
    try {
      const sheets = spreadsheet.getSheets();
      const result = sheets.map(sheet => {
        const data = sheet.getDataRange().getValues();
  
        // Zamiana każdego wiersza na tekst rozdzielony tabulatorem
        const lines = data.map(row => row.join('\t').trim());
  
        // Pomijamy puste wiersze
        return lines.filter(line => line.length > 0).join('\n');
  
      }).join('\n\n'); // oddzielamy arkusze pustą linią
  
      return result;
  
    } catch (e) {
      Logger.log(`❌ extractSheetText: błąd przetwarzania arkusza: ${e.message}`);
      return '';
    }
  }
  
  

  return {
    extractSheetText
  };
})();
